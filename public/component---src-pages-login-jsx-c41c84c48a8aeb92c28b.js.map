{"version":3,"sources":["webpack:///./src/components/Login/Login.js","webpack:///./src/helpers/data/dataLayer.js","webpack:///./src/pages/login.jsx"],"names":["Login","useEffect","checkSession","then","hasSession","navigate","window","location","replace","React","createElement","id","onSubmit","e","async","preventDefault","formData","FormData","append","target","elements","username","value","password","login","submitForm","InterpolLogo","type","placeholder","className","response","fetch","method","body","credentials","responseText","text","ok","Error","status","loginResponse","JSON","parse","error","console","log","message","userData","json","LoginPage","NoSSR","SEO","title","Head"],"mappings":"8FAAA,uEA4CeA,IAtCDA,KAeVC,oBAAU,KACNC,YAAa,WAAWC,KAAKC,IAEzBA,GAAcC,mBAAS,gBAE3BH,YAAa,UAAUC,KAAKC,IAExBA,GAAcE,OAAOC,SAASC,QAAQ,uCAE3C,IAGCC,IAAAC,cAAA,OAAKC,GAAG,gBACJF,IAAAC,cAAA,QAAMC,GAAG,YAAYC,SAAWC,IA1BrBC,WACfD,EAAEE,iBACF,MAAMC,EAAW,IAAIC,SACrBD,EAASE,OAAO,WAAYL,EAAEM,OAAOC,SAASC,SAASC,OACvDN,EAASE,OAAO,WAAYL,EAAEM,OAAOC,SAASG,SAASD,aAEhCE,YAAMR,IAEzBX,mBAAS,eAkB+BoB,CAAWZ,KAC/CJ,IAAAC,cAACgB,IAAY,MACbjB,IAAAC,cAAA,SAAOiB,KAAK,OAAOhB,GAAG,WAAWiB,YAAY,oBAC7CnB,IAAAC,cAAA,SAAOiB,KAAK,WAAWhB,GAAG,WAAWiB,YAAY,eACjDnB,IAAAC,cAAA,UAAQiB,KAAK,SAASE,UAAU,OAAMpB,IAAAC,cAAA,YAAM,iB,2DCtC5D,0EAEac,EAAQV,UACjB,IACI,MAAMgB,QAAiBC,MAAM,oDAAqD,CAC9EC,OAAQ,OACRC,KAAMjB,EACNkB,YAAa,YAGXC,QAAqBL,EAASM,OAEpC,IAAKN,EAASO,GACV,MAAM,IAAIC,MAAM,uBAAuBR,EAASS,QAGpD,MAAMC,EAAgBC,KAAKC,MAAMP,GAGjC,OAAIK,GAAiBA,EAAcG,OAC/BC,QAAQD,MAAM,eAAgBH,EAAcG,OACrCH,EAAcG,QAErBC,QAAQC,IAAI,oBAAqBL,EAAcM,UACxC,GAEb,MAAOH,GACLC,QAAQD,MAAM,0BAA2BA,KAIpCzC,EAAeY,UACxB,IACI,MAAMgB,QAAiBC,MAAM,gDAAqB,CAC9CC,OAAQ,MACRE,YAAa,YAGjB,IAAKJ,EAASO,GACV,MAAM,IAAIC,MAAM,uBAAuBR,EAASS,QAGpD,MAAMQ,QAAiBjB,EAASkB,OAEhC,OAAID,GAAYA,EAASJ,OACrBC,QAAQD,MAAM,0BAA2BI,EAASJ,QAC3C,GAIE,YAAThB,EACoB,YAAboB,EACS,WAATpB,GACa,WAAboB,EAIb,MAAOJ,GAEL,OADAC,QAAQD,MAAM,0BAA2BA,IAClC,K,kCC3Df,iIA6BeM,UAtBGA,KAGdhD,oBAAU,KACNC,YAAa,WAAWC,KAAKC,IAEzBA,GAAcC,mBAAS,gBAE3BH,YAAa,UAAUC,KAAKC,IAExBA,GAAcE,OAAOC,SAASC,QAAQ,uCAE3C,IAGCC,IAAAC,cAACwC,IAAK,KACFzC,IAAAC,cAACyC,IAAG,CAACC,MAAM,UACX3C,IAAAC,cAACV,IAAK,QAOX,MAAMqD,EAAOA,IAAM5C,IAAAC,cAAA,aAAO","file":"component---src-pages-login-jsx-c41c84c48a8aeb92c28b.js","sourcesContent":["import React, { useEffect } from \"react\";\nimport { navigate } from \"@reach/router\";\nimport { checkSession, login } from \"./../../helpers/data/dataLayer\";\nimport InterpolLogo from \"./../../assets/icons/InterpolLogo\";\nimport \"./Login.css\";\n\nconst Login = () => {\n    // LDAP login form\n    const submitForm = async (e) => {\n        e.preventDefault();\n        const formData = new FormData();\n        formData.append('username', e.target.elements.username.value);\n        formData.append('password', e.target.elements.password.value);\n        \n        const loggedIn = await login(formData);\n        if (loggedIn) {\n            navigate('/dashboard');\n        }\n    }\n\n    // Check if user is logged in as student or teacher\n    useEffect(() => {\n        checkSession(\"STUDENT\").then(hasSession => {\n            // if student, go to dashboard\n            hasSession && navigate('/dashboard');\n        });\n        checkSession(\"DOCENT\").then(hasSession => {\n            // if teacher, go to admin panel\n            hasSession && window.location.replace(\"https://admin.interpol.sd-lab.nl\");\n        });\n    }, []);\n\n    return (\n        <div id=\"loginWrapper\">            \n            <form id=\"loginForm\" onSubmit={(e) => { submitForm(e) }}>\n                <InterpolLogo />\n                <input type=\"text\" id=\"username\" placeholder=\"Studentennummer\" />\n                <input type=\"password\" id=\"password\" placeholder=\"Wachtwoord\" />\n                <button type=\"submit\" className=\"btn\"><span>Inloggen</span></button>\n            </form>\n        </div>\n    );\n}\n\nexport default Login;","const api = \"https://api.interpol.sd-lab.nl/api\";\n\nexport const login = async (formData) => {\n    try {\n        const response = await fetch('https://api.interpol.sd-lab.nl/api/create-session', {\n            method: 'POST',\n            body: formData,\n            credentials: 'include' // Ensure cookies are included with the request\n        });\n\n        const responseText = await response.text(); // Read the raw response body as text\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        const loginResponse = JSON.parse(responseText); // Parse the response text as JSON\n\n        // Do something with the login response, e.g., handle login success or error\n        if (loginResponse && loginResponse.error) {\n            console.error('Login error:', loginResponse.error);\n            return loginResponse.error;\n        } else {\n            console.log('Login successful:', loginResponse.message);\n            return true;\n        }\n    } catch (error) {\n        console.error('Error creating session:', error);\n    }\n}\n\nexport const checkSession = async (type) => {\n    try {\n        const response = await fetch(`${api}/check-type`, {\n            method: 'GET',\n            credentials: 'include' // Include cookies in the request\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        const userData = await response.json();\n\n        if (userData && userData.error) {\n            console.error('Error checking session:', userData.error);\n            return false;\n        }\n\n        // If user is logged in, check what type of user is logged in\n        if (type === \"STUDENT\") {\n            return userData === 'STUDENT' ? true : false;\n        } else if (type === \"DOCENT\") {\n            return userData === 'DOCENT' ? true : false;\n        } else {\n            return false;\n        }\n    } catch (error) {\n        console.error('Error checking session:', error);\n        return false;\n    }\n}\n","import React, { useEffect } from 'react';\nimport { navigate } from \"@reach/router\";\nimport NoSSR from '../components/NoSSR/NoSSR';\nimport { checkSession } from \"./../helpers/data/dataLayer\";\nimport Login from \"../components/Login/Login\";\nimport SEO from \"../components/SEO\";\n\nconst LoginPage = () => {\n\n    // Check if user is logged in as student or teacher\n    useEffect(() => {\n        checkSession(\"STUDENT\").then(hasSession => {\n            // if student, go to dashboard\n            hasSession && navigate('/dashboard');\n        });\n        checkSession(\"DOCENT\").then(hasSession => {\n            // if teacher, go to admin panel\n            hasSession && window.location.replace(\"https://admin.interpol.sd-lab.nl\");\n        });\n    }, []);\n\n    return (\n        <NoSSR>\n            <SEO title=\"Login\" />\n            <Login />\n        </NoSSR>\n    );\n}\n\nexport default LoginPage;\n\nexport const Head = () => <title>Interpol - Login</title>"],"sourceRoot":""}